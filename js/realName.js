var ui={txtName:sui.gel("txtName"),idCard:sui.gel("idCard"),btnSubmit:sui.gel("btnSubmit"),w:null,cardBefore:sui.gel("cardBefore"),cardBehind:sui.gel("cardBehind"),beforeUrl:null,behindUrl:null};(function(b){var a=document.getElementById("container");if(b.os.ios){a.classList.remove("mui-hidden");a.classList.add("ios-scroll-bounce")}b.plusReady(function(){if(b.os.android){setTimeout(function(){a.classList.remove("mui-hidden");a.classList.add("sui-fadeIn")},250)}ui.btnSubmit.addEventListener("tap",function(){var e=ui.txtName.value.trim();var d=ui.idCard.value.trim();if(sui.IsNullOrEmpty(e)){b.toast("请输入姓名");return}else{if(sui.IsNullOrEmpty(d)){b.toast("请输入身份证号码");return}else{if(!sui.checkIdCard(d)){b.toast("请输入正确的身份证号码");return}else{if(!ui.beforeUrl){b.toast("请上传身份证正面照");return}else{if(!ui.behindUrl){b.toast("请上传身份证反面照");return}}}}}ui.w=sui.wait("正在提交...");var c=plus.uploader.createUpload("https://app.cayica.com/User/RealName",{method:"POST"},function(g,f){if(f==200){var j=JSON.parse(g.responseText);var h=j.IsPass;if(h){sui.closewait(ui.w);var i=plus.webview.getWebviewById("info.html");if(i){i.evalJS("realTrue();")}sui.open("realState.html","realState.html",{});setTimeout(function(){var k=plus.webview.currentWebview();k.close("none",0)},500)}else{sui.closewait(ui.w);mui.toast(j.Desc)}}else{sui.closewait(ui.w);mui.toast("网络不给力，请检查网络设置")}});c.setRequestHeader("Token",sui.getToken());c.addData("name",e);c.addData("certNo",d);c.addFile(ui.beforeUrl,{key:"before"});c.addFile(ui.behindUrl,{key:"behind"});c.start()})})})(mui);mui("body").on("tap","div[data=tap]",function(){ui.txtName.blur();ui.idCard.blur();var b=this.getAttribute("data-v");var a=[{title:"拍照"},{title:"从相册选择"}];plus.nativeUI.actionSheet({title:"选择照片",cancel:"取消",buttons:a},function(f){var c=f.index;switch(c){case 0:break;case 1:var d=plus.camera.getCamera();d.captureImage(function(h){ui.w=sui.wait("请稍候...");var e="file://"+decodeURIComponent(plus.io.convertLocalFileSystemURL(h));var g="_documents/"+new Date().getTime()+".jpg";compressImage(e,g,function(j){var i="";if(j.success){i="file://"+plus.io.convertLocalFileSystemURL(j.path)}else{i=j.path}if(b=="zheng"){ui.beforeUrl=i;ui.cardBefore.src=i}else{ui.behindUrl=i;ui.cardBehind.src=i}sui.closewait(ui.w)})},function(e){});break;case 2:plus.gallery.pick(function(g){ui.w=sui.wait("请稍候...");var e="_documents/"+new Date().getTime()+".jpg";compressImage(decodeURIComponent(g),e,function(i){var h="";if(i.success){h="file://"+plus.io.convertLocalFileSystemURL(i.path)}else{h=i.path}if(b=="zheng"){ui.beforeUrl=h;ui.cardBefore.src=h}else{ui.behindUrl=h;ui.cardBehind.src=h}sui.closewait(ui.w)})},function(e){},null);break}})});var compressImage=function(b,a,c){plus.zip.compressImage({src:b,dst:a,quality:50,overwrite:true,format:"jpg",width:"100%",height:"auto"},function(d){rpath=a;var e={path:a,success:true};c(e)},function(f){var d={path:b,success:false};c(d)})};