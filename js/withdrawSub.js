var ui={container:sui.gel("containerBox"),index:1,w:null,elem:null,loopPullDown:null};var template=function(d,c,e,b){var a=['<div class="fund_l"><span>¥'+d+"</span><span>"+c+"</span></div>",'<div class="fund_r"><span> '+e+'</span><span class="fund_date">'+b+"</span></div>"].join("");return a};(function(a){a.init({gestureConfig:{longtap:true},pullRefresh:{container:"#pullrefresh",down:{callback:pulldownRefresh},up:{callback:pullupRefresh}}});a.plusReady(function(){setTimeout(function(){a("#pullrefresh").pullRefresh().pullupLoading()},180)})})(mui);function pulldownRefresh(){clearTimeout(ui.loopPullDown);setTimeout(function(){sui.request("Fund/GetWithdrawList",{pageIndex:1},true,function(g){if(g){var f=g.IsPass;if(f){var e=g.ReturnDataTable.length;if(e>0){ui.container.innerHTML="";ui.elem=sui.rtips(ui.elem);var c=sui.fragment();for(var d=0;d<e;d++){var b={Amout:sui.rmoney(g.ReturnDataTable[d].WithdrawAmout),time:sui.formatDate("y-m-d",g.ReturnDataTable[d].WithdrawTime),BankName:g.ReturnDataTable[d].BankName,State:g.ReturnDataTable[d].State,Id:g.ReturnDataTable[d].WithdrawId};var a=document.createElement("li");a.className="mui-table-view-cell";a.setAttribute("data","hold");a.setAttribute("data-s",b.State);a.setAttribute("data-id",b.Id);a.innerHTML=template(b.Amout,b.BankName,b.State,b.time);c.appendChild(a)}ui.container.appendChild(c);ui.container.classList.remove("mui-hidden");ui.index=2;mui("#pullrefresh").pullRefresh().endPulldownToRefresh();ui.loopPullDown=setTimeout(function(){mui("#pullrefresh").pullRefresh().enablePullupToRefresh();mui("#pullrefresh").pullRefresh().refresh(true)},1000)}else{mui("#pullrefresh").pullRefresh().endPulldownToRefresh();mui("#pullrefresh").pullRefresh().disablePullupToRefresh();ui.elem=sui.ctips("comiiszanwushuju","暂无提现记录")}}else{mui("#pullrefresh").pullRefresh().endPulldownToRefresh();mui.toast(g.Desc)}}else{mui("#pullrefresh").pullRefresh().endPulldownToRefresh();mui.toast("无法连接到服务器，请检查网络是否连接！")}})},500)}function pullupRefresh(){setTimeout(function(){sui.request("Fund/GetWithdrawList",{pageIndex:ui.index},true,function(g){if(g){var f=g.IsPass;if(f){var e=g.ReturnDataTable.length;if(e>0){var c=sui.fragment();for(var d=0;d<e;d++){var b={Amout:sui.rmoney(g.ReturnDataTable[d].WithdrawAmout),time:sui.formatDate("y-m-d",g.ReturnDataTable[d].WithdrawTime),BankName:g.ReturnDataTable[d].BankName,State:g.ReturnDataTable[d].State,Id:g.ReturnDataTable[d].WithdrawId};var a=document.createElement("li");a.className="mui-table-view-cell";a.setAttribute("data","hold");a.setAttribute("data-s",b.State);a.setAttribute("data-id",b.Id);a.innerHTML=template(b.Amout,b.BankName,b.State,b.time);c.appendChild(a)}ui.container.appendChild(c);if(ui.index==1){ui.container.classList.remove("mui-hidden")}ui.index++;mui("#pullrefresh").pullRefresh().endPullupToRefresh(false)}else{if(ui.index==1){mui("#pullrefresh").pullRefresh().endPullupToRefresh(true);mui("#pullrefresh").pullRefresh().disablePullupToRefresh();ui.elem=sui.ctips("comiiszanwushuju","暂无提现记录")}else{mui("#pullrefresh").pullRefresh().endPullupToRefresh(true)}}}else{mui.toast(g.Desc);mui("#pullrefresh").pullRefresh().endPullupToRefresh(false)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");mui("#pullrefresh").pullRefresh().endPullupToRefresh(false)}})},500)}mui(ui.container).on("longtap","li[data=hold]",function(){var b=this;var a=b.getAttribute("data-s");if(a=="审核中"){var d=b.getAttribute("data-id");var c=[{title:"取消提现",style:"destructive"}];plus.nativeUI.actionSheet({cancel:"取消",buttons:c},function(f){if(f.index==1){ui.w=sui.wait("正在取消...");sui.request("Fund/CancelWithdraw",{withdrawId:d},true,function(g){if(g){var e=g.IsPass;if(e){pulldownRefresh();mui.toast("取消提现成功")}else{mui.toast(g.Desc)}sui.closewait(ui.w)}else{mui.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w)}})}})}});