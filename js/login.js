var ui={txtMobile:sui.gel("txtMobile"),txtPwd:sui.gel("txtPwd"),btnLogin:sui.gel("btnLogin"),btnReg:sui.gel("btnReg"),btnForget:sui.gel("btnForget"),w:null,first:null};(function(a){a.plusReady(function(){a.init({beforeback:function(){var b=plus.webview.getWebviewById("my.html");var c=plus.webview.getWebviewById("cart.html");a.fire(b,"mycenter");c.evalJS("pulldownRefresh();")}});ui.btnLogin.addEventListener("tap",function(){var c=ui.txtMobile.value.trim();var d=ui.txtPwd.value.trim();if(sui.IsNullOrEmpty(c)){a.toast("请输入用户名或手机号");return}else{if(sui.IsNullOrEmpty(d)){a.toast("请输入密码");return}}ui.w=sui.wait("登录中...");var b={mobile:c,password:d};sui.post("Passport/Login",b,function(g){if(g){var f=g.IsPass;if(f){sui.removeToken();sui.setToken(g.ReturnObject);var e=plus.webview.getWebviewById("my.html");var h=plus.webview.getWebviewById("cart.html");a.fire(e,"mycenter");h.evalJS("pulldownRefresh();");sui.closewait(ui.w);setTimeout(function(){plus.webview.currentWebview().close()},300)}else{sui.closewait(ui.w);a.toast(g.Desc)}}else{sui.closewait(ui.w);a.toast("登陆失败，请检查网络是否连接")}})})})})(mui);ui.btnReg.addEventListener("tap",function(){sui.open("reg.html","reg.html",null)});ui.btnForget.addEventListener("tap",function(){sui.open("forgetPwd.html","forgetPwd.html",null)});mui("body").on("input","input",function(){var a=ui.txtMobile.value.trim();var b=ui.txtPwd.value.trim();if(!sui.IsNullOrEmpty(a)&&!sui.IsNullOrEmpty(b)){ui.btnLogin.removeAttribute("disabled")}else{ui.btnLogin.setAttribute("disabled","disabled")}});mui("body").on("tap",".mui-icon-clear",function(){var a=ui.txtMobile.value.trim();var b=ui.txtPwd.value.trim();if(!sui.IsNullOrEmpty(a)&&!sui.IsNullOrEmpty(b)){ui.btnLogin.removeAttribute("disabled")}else{ui.btnLogin.setAttribute("disabled","disabled")}});