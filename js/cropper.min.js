(function(b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{if(typeof exports==="object"){b(require("jquery"))}else{b(jQuery)}}})(function(an){var af=an(window),ax=an(document),aD=window.location,aL=".cropper",ab="preview"+aL,aJ=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,Z="cropper-modal",ao="cropper-hide",aj="cropper-hidden",ah="cropper-invisible",aO="cropper-move",ai="cropper-crop",ak="cropper-disabled",aS="cropper-bg",aE="mousedown touchstart",az="mousemove touchmove",ae="mouseup mouseleave touchend touchleave touchcancel",aM="wheel mousewheel DOMMouseScroll",aK="dblclick",aR="resize"+aL,ap="build"+aL,aA="built"+aL,aq="dragstart"+aL,at="dragmove"+aL,aG="dragend"+aL,ar="zoomin"+aL,aa="zoomout"+aL,aQ=an.isFunction(an("<canvas>")[0].getContext),al=Math.sqrt,Y=Math.min,aw=Math.max,au=Math.abs,aF=Math.sin,aN=Math.cos,ad=parseFloat,aB={};function X(a){return typeof a==="number"}function aC(a){return typeof a==="undefined"}function ay(c,b){var a=[];if(X(b)){a.push(b)}return a.slice.apply(c,a)}function ag(b,c){var a=ay(arguments,2);return function(){return b.apply(c,a.concat(ay(arguments)))}}function ac(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==aD.protocol||b[2]!==aD.hostname||b[3]!==aD.port)}function aH(a){var b="timestamp="+(new Date()).getTime();return(a+(a.indexOf("?")===-1?"?":"&")+b)}function W(a,b){return b.left<0&&a.width<(b.left+b.width)&&b.top<0&&a.height<(b.top+b.height)}function aI(a){return a?"rotate("+a+"deg)":"none"}function aP(k,j){var d=au(k.degree)%180,b=(d>90?(180-d):d)*Math.PI/180,i=aF(b),g=aN(b),c=k.width,f=k.height,h=k.aspectRatio,a,e;if(!j){a=c*g+f*i;e=c*i+f*g}else{a=c/(g+i/h);e=a/h}return{width:a,height:e}}function am(b,c){var f=an("<canvas>")[0],e=f.getContext("2d"),d=c.naturalWidth,a=c.naturalHeight,g=c.rotate,h=aP({width:d,height:a,degree:g});if(g){f.width=h.width;f.height=h.height;e.save();e.translate(h.width/2,h.height/2);e.rotate(g*Math.PI/180);e.drawImage(b,-d/2,-a/2,d,a);e.restore()}else{f.width=d;f.height=a;e.drawImage(b,0,0,d,a)}return f}function av(b,a){this.$element=an(b);this.options=an.extend({},av.DEFAULTS,an.isPlainObject(a)&&a);this.ready=false;this.built=false;this.rotated=false;this.cropped=false;this.disabled=false;this.canvas=null;this.cropBox=null;this.load()}aB.load=function(e){var d=this.options,b=this.$element,a,f,g,c;if(!e){if(b.is("img")){if(!b.attr("src")){return}e=b.prop("src")}else{if(b.is("canvas")&&aQ){e=b[0].toDataURL()}}}if(!e){return}g=an.Event(ap);b.one(ap,d.build).trigger(g);if(g.isDefaultPrevented()){return}if(d.checkImageOrigin&&ac(e)){a="anonymous";if(!b.prop("crossOrigin")){f=aH(e)}}this.$clone=c=an("<img>");c.one("load",an.proxy(function(){var i=c.prop("naturalWidth")||c.width(),h=c.prop("naturalHeight")||c.height();this.image={naturalWidth:i,naturalHeight:h,aspectRatio:i/h,rotate:0};this.url=e;this.ready=true;this.build()},this)).one("error",function(){c.remove()}).attr({src:f||e,crossOrigin:a});c.addClass(ao).insertAfter(b)};aB.build=function(){var c=this.$element,b=this.$clone,d=this.options,e,a;if(!this.ready){return}if(this.built){this.unbuild()}this.$cropper=e=an(av.TEMPLATE);c.addClass(aj);b.removeClass(ao);this.$container=c.parent().append(e);this.$canvas=e.find(".cropper-canvas").append(b);this.$dragBox=e.find(".cropper-drag-box");this.$cropBox=a=e.find(".cropper-crop-box");this.$viewBox=e.find(".cropper-view-box");this.addListeners();this.initPreview();d.aspectRatio=ad(d.aspectRatio)||NaN;if(d.autoCrop){this.cropped=true;if(d.modal){this.$dragBox.addClass(Z)}}else{a.addClass(aj)}if(d.background){e.addClass(aS)}if(!d.highlight){a.find(".cropper-face").addClass(ah)}if(!d.guides){a.find(".cropper-dashed").addClass(aj)}if(!d.movable){a.find(".cropper-face").data("drag","move")}if(!d.resizable){a.find(".cropper-line, .cropper-point").addClass(aj)}this.setDragMode(d.dragCrop?"crop":"move");this.built=true;this.render();c.one(aA,d.built).trigger(aA)};aB.unbuild=function(){if(!this.built){return}this.built=false;this.container=null;this.canvas=null;this.cropBox=null;this.removeListeners();this.resetPreview();this.$preview=null;this.$viewBox=null;this.$cropBox=null;this.$dragBox=null;this.$canvas=null;this.$container=null;this.$cropper.remove();this.$cropper=null};an.extend(aB,{render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();if(this.cropped){this.renderCropBox()}},initContainer:function(){var c=this.$element,b=this.$container,a=this.$cropper,d=this.options;a.addClass(aj);c.removeClass(aj);a.css((this.container={width:aw(b.width(),ad(d.minContainerWidth)||200),height:aw(b.height(),ad(d.minContainerHeight)||100)}));c.addClass(aj);a.removeClass(aj)},initCanvas:function(){var a=this.container,d=a.width,c=a.height,b=this.image,e=b.aspectRatio,f={aspectRatio:e,width:d,height:c};if(c*e>d){f.height=d/e}else{f.width=c*e}f.oldLeft=f.left=(d-f.width)/2;f.oldTop=f.top=(c-f.height)/2;this.canvas=f;this.limitCanvas(true,true);this.initialImage=an.extend({},b);this.initialCanvas=an.extend({},f)},limitCanvas:function(g,b){var f=this.options,k=f.strict,e=this.container,l=e.width,h=e.height,d=this.canvas,j=d.aspectRatio,c=this.cropBox,m=this.cropped&&c,i,a;if(g){i=ad(f.minCanvasWidth)||0;a=ad(f.minCanvasHeight)||0;if(i){if(k){i=aw(m?c.width:l,i)}a=i/j}else{if(a){if(k){a=aw(m?c.height:h,a)}i=a*j}else{if(k){if(m){i=c.width;a=c.height;if(a*j>i){i=a*j}else{a=i/j}}else{i=l;a=h;if(a*j>i){a=i/j}else{i=a*j}}}}}an.extend(d,{minWidth:i,minHeight:a,maxWidth:Infinity,maxHeight:Infinity})}if(b){if(k){if(m){d.minLeft=Y(c.left,(c.left+c.width)-d.width);d.minTop=Y(c.top,(c.top+c.height)-d.height);d.maxLeft=c.left;d.maxTop=c.top}else{d.minLeft=Y(0,l-d.width);d.minTop=Y(0,h-d.height);d.maxLeft=aw(0,l-d.width);d.maxTop=aw(0,h-d.height)}}else{d.minLeft=-d.width;d.minTop=-d.height;d.maxLeft=l;d.maxTop=h}}},renderCanvas:function(b){var e=this.options,f=this.canvas,d=this.image,c,a;if(this.rotated){this.rotated=false;a=aP({width:d.width,height:d.height,degree:d.rotate});c=a.width/a.height;if(c!==f.aspectRatio){f.left-=(a.width-f.width)/2;f.top-=(a.height-f.height)/2;f.width=a.width;f.height=a.height;f.aspectRatio=c;this.limitCanvas(true,false)}}if(f.width>f.maxWidth||f.width<f.minWidth){f.left=f.oldLeft}if(f.height>f.maxHeight||f.height<f.minHeight){f.top=f.oldTop}f.width=Y(aw(f.width,f.minWidth),f.maxWidth);f.height=Y(aw(f.height,f.minHeight),f.maxHeight);this.limitCanvas(false,true);f.oldLeft=f.left=Y(aw(f.left,f.minLeft),f.maxLeft);f.oldTop=f.top=Y(aw(f.top,f.minTop),f.maxTop);this.$canvas.css({width:f.width,height:f.height,left:f.left,top:f.top});this.renderImage();if(this.cropped&&e.strict&&!W(this.container,f)){this.limitCropBox(true,true)}if(b){this.output()}},renderImage:function(){var a=this.canvas,c=this.image,b;if(c.rotate){b=aP({width:a.width,height:a.height,degree:c.rotate,aspectRatio:c.aspectRatio},true)}an.extend(c,b?{width:b.width,height:b.height,left:(a.width-b.width)/2,top:(a.height-b.height)/2}:{width:a.width,height:a.height,left:0,top:0});this.$clone.css({width:c.width,height:c.height,marginLeft:c.left,marginTop:c.top,transform:aI(c.rotate)})},initCropBox:function(){var e=this.options,a=this.canvas,c=e.aspectRatio,b=ad(e.autoCropArea)||0.8,d={width:a.width,height:a.height};if(c){if(a.height*c>a.width){d.height=d.width/c}else{d.width=d.height*c}}this.cropBox=d;this.limitCropBox(true,true);d.width=Y(aw(d.width,d.minWidth),d.maxWidth);d.height=Y(aw(d.height,d.minHeight),d.maxHeight);d.width=aw(d.minWidth,d.width*b);d.height=aw(d.minHeight,d.height*b);d.oldLeft=d.left=a.left+(a.width-d.width)/2;d.oldTop=d.top=a.top+(a.height-d.height)/2;this.initialCropBox=an.extend({},d)},limitCropBox:function(g,a){var f=this.options,j=f.strict,d=this.container,k=d.width,h=d.height,c=this.canvas,b=this.cropBox,i=f.aspectRatio,e,l;if(g){e=ad(f.minCropBoxWidth)||0;l=ad(f.minCropBoxHeight)||0;b.minWidth=Y(k,e);b.minHeight=Y(h,l);b.maxWidth=Y(k,j?c.width:k);b.maxHeight=Y(h,j?c.height:h);if(i){if(b.maxHeight*i>b.maxWidth){b.minHeight=b.minWidth/i;b.maxHeight=b.maxWidth/i}else{b.minWidth=b.minHeight*i;b.maxWidth=b.maxHeight*i}}b.minWidth=Y(b.maxWidth,b.minWidth);b.minHeight=Y(b.maxHeight,b.minHeight)}if(a){if(j){b.minLeft=aw(0,c.left);b.minTop=aw(0,c.top);b.maxLeft=Y(k,c.left+c.width)-b.width;b.maxTop=Y(h,c.top+c.height)-b.height}else{b.minLeft=0;b.minTop=0;b.maxLeft=k-b.width;b.maxTop=h-b.height}}},renderCropBox:function(){var e=this.options,a=this.container,b=a.width,d=a.height,f=this.$cropBox,c=this.cropBox;if(c.width>c.maxWidth||c.width<c.minWidth){c.left=c.oldLeft}if(c.height>c.maxHeight||c.height<c.minHeight){c.top=c.oldTop}c.width=Y(aw(c.width,c.minWidth),c.maxWidth);c.height=Y(aw(c.height,c.minHeight),c.maxHeight);this.limitCropBox(false,true);c.oldLeft=c.left=Y(aw(c.left,c.minLeft),c.maxLeft);c.oldTop=c.top=Y(aw(c.top,c.minTop),c.maxTop);if(e.movable){f.find(".cropper-face").data("drag",(c.width===b&&c.height===d)?"move":"all")}f.css({width:c.width,height:c.height,left:c.left,top:c.top});if(this.cropped&&e.strict&&!W(a,this.canvas)){this.limitCanvas(true,true)}if(!this.disabled){this.output()}},output:function(){var a=this.options;this.preview();if(a.crop){a.crop.call(this.$element,this.getData())}}});aB.initPreview=function(){var a=this.url;this.$preview=an(this.options.preview);this.$viewBox.html('<img src="'+a+'">');this.$preview.each(function(){var b=an(this);b.data(ab,{width:b.width(),height:b.height(),original:b.html()}).html('<img src="'+a+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">')})};aB.resetPreview=function(){this.$preview.each(function(){var a=an(this);a.html(a.data(ab).original).removeData(ab)})};aB.preview=function(){var b=this.image,g=this.canvas,f=this.cropBox,e=b.width,a=b.height,c=f.left-g.left-b.left,d=f.top-g.top-b.top,h=b.rotate;if(!this.cropped||this.disabled){return}this.$viewBox.find("img").css({width:e,height:a,marginLeft:-c,marginTop:-d,transform:aI(h)});this.$preview.each(function(){var i=an(this),j=i.data(ab),l=j.width/f.width,k=j.width,m=f.height*l;if(m>j.height){l=j.height/f.height;k=f.width*l;m=j.height}i.width(k).height(m).find("img").css({width:e*l,height:a*l,marginLeft:-c*l,marginTop:-d*l,transform:aI(h)})})};aB.addListeners=function(){var a=this.options;this.$element.on(aq,a.dragstart).on(at,a.dragmove).on(aG,a.dragend).on(ar,a.zoomin).on(aa,a.zoomout);this.$cropper.on(aE,an.proxy(this.dragstart,this)).on(aK,an.proxy(this.dblclick,this));if(a.zoomable&&a.mouseWheelZoom){this.$cropper.on(aM,an.proxy(this.wheel,this))}ax.on(az,(this._dragmove=ag(this.dragmove,this))).on(ae,(this._dragend=ag(this.dragend,this)));if(a.responsive){af.on(aR,(this._resize=ag(this.resize,this)))}};aB.removeListeners=function(){var a=this.options;this.$element.off(aq,a.dragstart).off(at,a.dragmove).off(aG,a.dragend).off(ar,a.zoomin).off(aa,a.zoomout);this.$cropper.off(aE,this.dragstart).off(aK,this.dblclick);if(a.zoomable&&a.mouseWheelZoom){this.$cropper.off(aM,this.wheel)}ax.off(az,this._dragmove).off(ae,this._dragend);if(a.responsive){af.off(aR,this._resize)}};an.extend(aB,{resize:function(){var c=this.$container,a=this.container,e,b,d;if(this.disabled){return}d=c.width()/a.width;if(d!==1||c.height()!==a.height){e=this.getCanvasData();b=this.getCropBoxData();this.render();this.setCanvasData(an.each(e,function(g,f){e[g]=f*d}));this.setCropBoxData(an.each(b,function(g,f){b[g]=f*d}))}},dblclick:function(){if(this.disabled){return}if(this.$dragBox.hasClass(ai)){this.setDragMode("move")}else{this.setDragMode("crop")}},wheel:function(a){var c=a.originalEvent,b=1;if(this.disabled){return}a.preventDefault();if(c.deltaY){b=c.deltaY>0?1:-1}else{if(c.wheelDelta){b=-c.wheelDelta/120}else{if(c.detail){b=c.detail>0?1:-1}}}this.zoom(-b*0.1)},dragstart:function(d){var g=this.options,a=d.originalEvent,b=a&&a.touches,c=d,f,e,h;if(this.disabled){return}if(b){h=b.length;if(h>1){if(g.zoomable&&g.touchDragZoom&&h===2){c=b[1];this.startX2=c.pageX;this.startY2=c.pageY;f="zoom"}else{return}}c=b[0]}f=f||an(c.target).data("drag");if(aJ.test(f)){d.preventDefault();e=an.Event(aq,{originalEvent:a,dragType:f});this.$element.trigger(e);if(e.isDefaultPrevented()){return}this.dragType=f;this.cropping=false;this.startX=c.pageX;this.startY=c.pageY;if(f==="crop"){this.cropping=true;this.$dragBox.addClass(Z)}}},dragmove:function(f){var g=this.options,a=f.originalEvent,b=a&&a.touches,c=f,e=this.dragType,d,h;if(this.disabled){return}if(b){h=b.length;if(h>1){if(g.zoomable&&g.touchDragZoom&&h===2){c=b[1];this.endX2=c.pageX;this.endY2=c.pageY}else{return}}c=b[0]}if(e){f.preventDefault();d=an.Event(at,{originalEvent:a,dragType:e});this.$element.trigger(d);if(d.isDefaultPrevented()){return}this.endX=c.pageX;this.endY=c.pageY;this.change()}},dragend:function(c){var a=this.dragType,b;if(this.disabled){return}if(a){c.preventDefault();b=an.Event(aG,{originalEvent:c.originalEvent,dragType:a});this.$element.trigger(b);if(b.isDefaultPrevented()){return}if(this.cropping){this.cropping=false;this.$dragBox.toggleClass(Z,this.cropped&&this.options.modal)}this.dragType=""}}});an.extend(aB,{reset:function(){if(!this.built||this.disabled){return}this.image=an.extend({},this.initialImage);this.canvas=an.extend({},this.initialCanvas);this.renderCanvas();if(this.cropped){this.cropBox=an.extend({},this.initialCropBox);this.renderCropBox()}},clear:function(){if(!this.cropped||this.disabled){return}an.extend(this.cropBox,{left:0,top:0,width:0,height:0});this.cropped=false;this.renderCropBox();this.limitCanvas();this.renderCanvas();this.$dragBox.removeClass(Z);this.$cropBox.addClass(aj)},destroy:function(){var a=this.$element;if(this.ready){this.unbuild();a.removeClass(aj)}else{this.$clone.off("load").remove()}a.removeData("cropper")},replace:function(a){if(!this.disabled&&a){this.load(a)}},enable:function(){if(this.built){this.disabled=false;this.$cropper.removeClass(ak)}},disable:function(){if(this.built){this.disabled=true;this.$cropper.addClass(ak)}},move:function(a,b){var c=this.canvas;if(this.built&&!this.disabled&&X(a)&&X(b)){c.left+=a;c.top+=b;this.renderCanvas(true)}},zoom:function(c){var e=this.canvas,b,d,a;c=ad(c);if(c&&this.built&&!this.disabled&&this.options.zoomable){b=c>0?an.Event(ar):an.Event(aa);this.$element.trigger(b);if(b.isDefaultPrevented()){return}c=c<=-1?1/(1-c):c<=1?(1+c):c;d=e.width*c;a=e.height*c;e.left-=(d-e.width)/2;e.top-=(a-e.height)/2;e.width=d;e.height=a;this.renderCanvas(true);this.setDragMode("move")}},rotate:function(b){var a=this.image;b=ad(b);if(b&&this.built&&!this.disabled&&this.options.rotatable){a.rotate=(a.rotate+b)%360;this.rotated=true;this.renderCanvas(true)}},getData:function(){var d=this.cropBox,a=this.canvas,c=this.image,e,b;if(this.built&&this.cropped){b={x:d.left-a.left,y:d.top-a.top,width:d.width,height:d.height};e=c.width/c.naturalWidth;an.each(b,function(g,f){f=f/e;b[g]=f})}else{b={x:0,y:0,width:0,height:0}}b.rotate=c.rotate;return b},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a=this.canvas,b;if(this.built){b={left:a.left,top:a.top,width:a.width,height:a.height}}return b||{}},setCanvasData:function(b){var a=this.canvas,c=a.aspectRatio;if(this.built&&!this.disabled&&an.isPlainObject(b)){if(X(b.left)){a.left=b.left}if(X(b.top)){a.top=b.top}if(X(b.width)){a.width=b.width;a.height=b.width/c}else{if(X(b.height)){a.height=b.height;a.width=b.height*c}}this.renderCanvas(true)}},getCropBoxData:function(){var a=this.cropBox,b;if(this.built&&this.cropped){b={left:a.left,top:a.top,width:a.width,height:a.height}}return b||{}},setCropBoxData:function(b){var a=this.cropBox,c=this.options.aspectRatio;if(this.built&&this.cropped&&!this.disabled&&an.isPlainObject(b)){if(X(b.left)){a.left=b.left}if(X(b.top)){a.top=b.top}if(c){if(X(b.width)){a.width=b.width;a.height=a.width/c}else{if(X(b.height)){a.height=b.height;a.width=a.height*c}}}else{if(X(b.width)){a.width=b.width}if(X(b.height)){a.height=b.height}}this.renderCropBox()}},getCroppedCanvas:function(f){var d,l,b,j,k,i,g,h,c,e,a;if(!this.built||!this.cropped||!aQ){return}if(!an.isPlainObject(f)){f={}}a=this.getData();d=a.width;l=a.height;h=d/l;if(an.isPlainObject(f)){k=f.width;i=f.height;if(k){i=k/h;g=k/d}else{if(i){k=i*h;g=i/l}}}b=k||d;j=i||l;c=an("<canvas>")[0];c.width=b;c.height=j;e=c.getContext("2d");if(f.fillColor){e.fillStyle=f.fillColor;e.fillRect(0,0,b,j)}e.drawImage.apply(e,(function(){var x=am(this.$clone[0],this.image),w=x.width,v=x.height,r=[x],s=a.x,t=a.y,u,m,o,p,n,q;if(s<=-d||s>w){s=u=o=n=0}else{if(s<=0){o=-s;s=0;u=n=Y(w,d+s)}else{if(s<=w){o=0;u=n=Y(d,w-s)}}}if(u<=0||t<=-l||t>v){t=m=p=q=0}else{if(t<=0){p=-t;t=0;m=q=Y(v,l+t)}else{if(t<=v){p=0;m=q=Y(l,v-t)}}}r.push(s,t,u,m);if(g){o*=g;p*=g;n*=g;q*=g}if(n>0&&q>0){r.push(o,p,n,q)}return r}).call(this));return c},setAspectRatio:function(b){var a=this.options;if(!this.disabled&&!aC(b)){a.aspectRatio=ad(b)||NaN;if(this.built){this.initCropBox();if(this.cropped){this.renderCropBox()}}}},setDragMode:function(b){var d=this.$dragBox,a=false,c=false;if(!this.ready||this.disabled){return}switch(b){case"crop":if(this.options.dragCrop){a=true;d.data("drag",b)}else{c=true}break;case"move":c=true;d.data("drag",b);break;default:d.removeData("drag")}d.toggleClass(ai,a).toggleClass(aO,c)}});aB.change=function(){var p=this.dragType,a=this.options,b=this.canvas,n=this.container,d=this.cropBox,h=d.width,k=d.height,s=d.left,l=d.top,e=s+h,q=l+k,j=0,o=0,f=n.width,i=n.height,g=true,c=a.aspectRatio,m={x:this.endX-this.startX,y:this.endY-this.startY},r;if(a.strict){j=d.minLeft;o=d.minTop;f=j+Y(n.width,b.width);i=o+Y(n.height,b.height)}if(c){m.X=m.y*c;m.Y=m.x/c}switch(p){case"all":s+=m.x;l+=m.y;break;case"e":if(m.x>=0&&(e>=f||c&&(l<=o||q>=i))){g=false;break}h+=m.x;if(c){k=h/c;l-=m.Y/2}if(h<0){p="w";h=0}break;case"n":if(m.y<=0&&(l<=o||c&&(s<=j||e>=f))){g=false;break}k-=m.y;l+=m.y;if(c){h=k*c;s+=m.X/2}if(k<0){p="s";k=0}break;case"w":if(m.x<=0&&(s<=j||c&&(l<=o||q>=i))){g=false;break}h-=m.x;s+=m.x;if(c){k=h/c;l+=m.Y/2}if(h<0){p="e";h=0}break;case"s":if(m.y>=0&&(q>=i||c&&(s<=j||e>=f))){g=false;break}k+=m.y;if(c){h=k*c;s-=m.X/2}if(k<0){p="n";k=0}break;case"ne":if(c){if(m.y<=0&&(l<=o||e>=f)){g=false;break}k-=m.y;l+=m.y;h=k*c}else{if(m.x>=0){if(e<f){h+=m.x}else{if(m.y<=0&&l<=o){g=false}}}else{h+=m.x}if(m.y<=0){if(l>0){k-=m.y;l+=m.y}}else{k-=m.y;l+=m.y}}if(h<0&&k<0){p="sw";k=0;h=0}else{if(h<0){p="nw";h=0}else{if(k<0){p="se";k=0}}}break;case"nw":if(c){if(m.y<=0&&(l<=o||s<=j)){g=false;break}k-=m.y;l+=m.y;h=k*c;s+=m.X}else{if(m.x<=0){if(s>0){h-=m.x;s+=m.x}else{if(m.y<=0&&l<=o){g=false}}}else{h-=m.x;s+=m.x}if(m.y<=0){if(l>0){k-=m.y;l+=m.y}}else{k-=m.y;l+=m.y}}if(h<0&&k<0){p="se";k=0;h=0}else{if(h<0){p="ne";h=0}else{if(k<0){p="sw";k=0}}}break;case"sw":if(c){if(m.x<=0&&(s<=j||q>=i)){g=false;break}h-=m.x;s+=m.x;k=h/c}else{if(m.x<=0){if(s>0){h-=m.x;s+=m.x}else{if(m.y>=0&&q>=i){g=false}}}else{h-=m.x;s+=m.x}if(m.y>=0){if(q<i){k+=m.y}}else{k+=m.y}}if(h<0&&k<0){p="ne";k=0;h=0}else{if(h<0){p="se";h=0}else{if(k<0){p="nw";k=0}}}break;case"se":if(c){if(m.x>=0&&(e>=f||q>=i)){g=false;break}h+=m.x;k=h/c}else{if(m.x>=0){if(e<f){h+=m.x}else{if(m.y>=0&&q>=i){g=false}}}else{h+=m.x}if(m.y>=0){if(q<i){k+=m.y}}else{k+=m.y}}if(h<0&&k<0){p="nw";k=0;h=0}else{if(h<0){p="sw";h=0}else{if(k<0){p="ne";k=0}}}break;case"move":b.left+=m.x;b.top+=m.y;this.renderCanvas(true);g=false;break;case"zoom":this.zoom(function(v,t,w,u){var x=al(v*v+t*t),y=al(w*w+u*u);return(y-x)/x}(au(this.startX-this.startX2),au(this.startY-this.startY2),au(this.endX-this.endX2),au(this.endY-this.endY2)));this.startX2=this.endX2;this.startY2=this.endY2;g=false;break;case"crop":if(m.x&&m.y){r=this.$cropper.offset();s=this.startX-r.left;l=this.startY-r.top;h=d.minWidth;k=d.minHeight;if(m.x>0){if(m.y>0){p="se"}else{p="ne";l-=k}}else{if(m.y>0){p="sw";s-=h}else{p="nw";s-=h;l-=k}}if(!this.cropped){this.cropped=true;this.$cropBox.removeClass(aj)}}break}if(g){d.width=h;d.height=k;d.left=s;d.top=l;this.dragType=p;this.renderCropBox()}this.startX=this.endX;this.startY=this.endY};an.extend(av.prototype,aB);av.DEFAULTS={aspectRatio:NaN,autoCropArea:0.8,crop:null,preview:"",strict:true,responsive:true,checkImageOrigin:true,modal:true,guides:true,highlight:true,background:true,autoCrop:true,dragCrop:true,movable:true,resizable:true,rotatable:true,zoomable:true,touchDragZoom:true,mouseWheelZoom:true,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null};av.setDefaults=function(a){an.extend(av.DEFAULTS,a)};av.TEMPLATE=(function(a,b){b=b.split(",");return a.replace(/\d+/g,function(c){return b[c]})})('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9" 3-2="move"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face" 3-2="all"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,drag,data,point,cropper,class,line,dashed,box");av.other=an.fn.cropper;an.fn.cropper=function(b){var c=ay(arguments,1),a;this.each(function(){var d=an(this),f=d.data("cropper"),e;if(!f){d.data("cropper",(f=new av(this,b)))}if(typeof b==="string"&&an.isFunction((e=f[b]))){a=e.apply(f,c)}});return aC(a)?this:a};an.fn.cropper.Constructor=av;an.fn.cropper.setDefaults=av.setDefaults;an.fn.cropper.noConflict=function(){an.fn.cropper=av.other;return this}});