var ui={elem:null,container:sui.gel("container"),index:1,msgType:null,loopPullDown:null};(function(a){a.init({pullRefresh:{container:"#pullrefresh",down:{callback:pulldownRefresh},up:{callback:pullupRefresh}}});a.plusReady(function(){ui.msgType=plus.webview.currentWebview().msgType;setTimeout(function(){a("#pullrefresh").pullRefresh().pullupLoading()},180)})})(mui);function pulldownRefresh(){clearTimeout(ui.loopPullDown);setTimeout(function(){sui.request("Home/MessageList",{messageType:ui.msgType,pageIndex:1},true,function(f){if(f){var e=f.IsPass;if(e){var d=f.ReturnList.length;ui.container.innerHTML="";if(d>0){ui.elem=sui.rtips(ui.elem);var b=sui.fragment();for(var c=0;c<d;c++){var a=document.createElement("li");a.className="mui-table-view-cell";a.setAttribute("data","detail");a.setAttribute("data-v",f.ReturnList[c].Id);a.innerHTML='<a class="mui-navigate-right"><div class="mui-ellipsis '+(f.ReturnList[c].State==1?"already":"")+'">'+(f.ReturnList[c].State==1?"":'<span class="mui-badge-self"></span>')+f.ReturnList[c].Title+"</div><p> "+f.ReturnList[c].InputTime+"</p></a>";b.appendChild(a)}ui.container.appendChild(b);ui.container.classList.remove("mui-hidden");ui.index=2;mui("#pullrefresh").pullRefresh().endPulldownToRefresh();ui.loopPullDown=setTimeout(function(){mui("#pullrefresh").pullRefresh().enablePullupToRefresh();mui("#pullrefresh").pullRefresh().refresh(true)},1000)}else{mui("#pullrefresh").pullRefresh().endPulldownToRefresh();mui("#pullrefresh").pullRefresh().disablePullupToRefresh();ui.container.classList.add("mui-hidden");ui.elem=sui.ctips("comiiszanwushuju","暂无相关数据")}}else{mui("#pullrefresh").pullRefresh().endPulldownToRefresh();mui.toast(f.Desc)}}else{mui("#pullrefresh").pullRefresh().endPulldownToRefresh();mui.toast("无法连接到服务器，请检查网络是否连接！")}})},400)}function pullupRefresh(){setTimeout(function(){sui.request("Home/MessageList",{messageType:ui.msgType,pageIndex:ui.index},true,function(f){if(f){var e=f.IsPass;if(e){var d=f.ReturnList.length;if(d>0){var b=sui.fragment();for(var c=0;c<d;c++){var a=document.createElement("li");a.className="mui-table-view-cell";a.setAttribute("data","detail");a.setAttribute("data-v",f.ReturnList[c].Id);a.innerHTML='<a class="mui-navigate-right"><div class="mui-ellipsis '+(f.ReturnList[c].State==1?"already":"")+'">'+(f.ReturnList[c].State==1?"":'<span class="mui-badge-self"></span>')+f.ReturnList[c].Title+"</div><p> "+f.ReturnList[c].InputTime+"</p></a>";b.appendChild(a)}ui.container.appendChild(b);if(ui.index==1){ui.container.classList.remove("mui-hidden")}ui.index++;mui("#pullrefresh").pullRefresh().endPullupToRefresh(false)}else{if(ui.index==1){mui("#pullrefresh").pullRefresh().endPullupToRefresh(true);mui("#pullrefresh").pullRefresh().disablePullupToRefresh();ui.elem=sui.ctips("comiiszanwushuju","暂无相关数据")}else{mui("#pullrefresh").pullRefresh().endPullupToRefresh(true)}}}else{mui.toast(f.Desc);mui("#pullrefresh").pullRefresh().endPullupToRefresh(false)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");mui("#pullrefresh").pullRefresh().endPullupToRefresh(false)}})},400)}mui(ui.container).on("tap","li[data=detail]",function(){var a=this.getAttribute("data-v");sui.open("msgDetail.html","msgDetail.html",{msgId:a})});