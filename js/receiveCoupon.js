var ui={apply:sui.gel("apply"),w:null,container:sui.gel("container"),pid:"",channel:2,scontent:sui.gel("scontent"),elem:null};var couponFunc=function(a){sui.request("Home/ProductQuanList",{productSkuId:a,useRange:3},true,function(h){if(h){var g=h.IsPass;if(g){var c=h.ReturnList.length;if(c){var e="";for(var f=0;f<c;f++){var b={Id:h.ReturnList[f].Id,Name:h.ReturnList[f].Name,QuanType:h.ReturnList[f].QuanType,Amount:h.ReturnList[f].Amount,ValidTime:h.ReturnList[f].ValidTime,UseCategory:h.ReturnList[f].UseCategory,CanGet:h.ReturnList[f].CanGet};var j={border:"",classVal:"primary",word:"租",state:"立即领取",fontsize:"",length:b.Amount.length};if(j.length==3||j.length==4){j.fontsize="font-size3"}else{if(j.length>=5){j.fontsize="font-size5"}}if(b.CanGet){if(b.QuanType==0){j.border="border";j.word="押";j.classVal="main"}}else{if(b.QuanType==0){j.word="押"}j.border="border2";j.state="已经领取";j.classVal="gray"}e+='<div class="quan-box"><div class="desc '+j.border+'"><div class="box"><span class="mui-badge-circle">'+j.word+"</span>";e+='<span class="quandesc"><span class="mui-ellipsis">'+b.Name+'</span><span class="mui-ellipsis">'+b.UseCategory+"</span>";e+='</span></div><div class="date"> 有效日期：'+b.ValidTime+'</div></div><ul class="quan" >';e+='<li class="'+j.classVal+" "+j.fontsize+'" data="'+(b.CanGet==true?"com":"")+'" data-v="'+b.Id+'"><span class="sign">¥</span>'+b.Amount+'<span class="sign block">'+j.state+"</span></li></ul></div>"}ui.container.innerHTML=e}else{ui.elem=sui.ctips("comiiszanwushuju","暂无可领取的优惠券")}sui.closewait(ui.w)}else{mui.toast(h.Desc);sui.closewait(ui.w)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");sui.closewait(ui.w)}})};(function(a){if(a.os.ios){ui.scontent.classList.add("ios-scroll-bounce")}a.plusReady(function(){ui.channel=plus.os.name=="Android"?2:3;var b=plus.webview.currentWebview();ui.pid=b.pid;setTimeout(function(){ui.w=sui.wait("正在加载...");couponFunc(ui.pid)},250)})})(mui);mui(ui.container).on("tap","li[data=com]",function(){var a=this.getAttribute("data-v");ui.w=sui.wait("请稍候...");sui.post("Home/ReceiveQuan",{quanId:a,channel:ui.channel},function(c){if(c){var b=c.IsPass;if(b){couponFunc(ui.pid);mui.toast("领取成功");sui.closewait(ui.w)}else{mui.toast(c.Desc);sui.closewait(ui.w)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");sui.closewait(ui.w)}})});