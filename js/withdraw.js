var ui={txtName:sui.gel("txtName"),txtbankCard:sui.gel("txtbankCard"),txtMoney:sui.gel("txtMoney"),tradePwd:sui.gel("tradePwd"),forget:sui.gel("forget"),btnSure:sui.gel("btnSure"),w:null,picker:null,len:0,min:100,AvailBal:0,StatusCode:"",Desc:"",channel:2};function refresh(){sui.request("Fund/GetBankList",{},true,function(g){if(g){var e=g.IsPass;ui.AvailBal=g.ReturnObject.AvailBal;ui.txtMoney.placeholder="可提现"+sui.rmoney(ui.AvailBal)+"元";ui.min=g.ReturnObject.MinWithdrawAmount||100;if(e){ui.len=g.ReturnObject.BankCardList.length;if(ui.len>0){var d=[];for(var c=0;c<ui.len;c++){var a={CardNo:g.ReturnObject.BankCardList[c].CardNo,BankName:g.ReturnObject.BankCardList[c].BankName,Id:g.ReturnObject.BankCardList[c].Id};var f="";if(~a.BankName.indexOf("宝")||~a.BankName.indexOf("微")){f=a.BankName+" "+a.CardNo}else{f=a.BankName+" 尾号"+a.CardNo.substr(a.CardNo.length-4,4)}if(c==0){ui.txtbankCard.value=f;ui.txtbankCard.setAttribute("data",a.Id)}d[c]={text:f,value:a.Id}}ui.picker=new mui.PopPicker();ui.picker.setData(d);var b=document.querySelector(".mui-poppicker-body");if(mui.os.ios&&parseFloat(mui.os.version)>8&&b){b.classList.add("ios-poppicker")}}else{ui.txtbankCard.value="添加收款账号"}ui.txtName.value=g.ReturnObject.AccName;sui.closewait(ui.w)}else{ui.StatusCode=g.StatusCode;if(ui.StatusCode=="S2000"){ui.txtName.value="实名认证审核中，点击查看";ui.Desc=g.Desc}else{if(ui.StatusCode=="S2001"){ui.txtName.value="实名认证未通过，点击查看";ui.Desc=g.Desc}else{if(ui.StatusCode=="S0014"){ui.txtName.value="未实名认证，马上去认证";ui.Desc=g.Desc}}}mui.toast(g.Desc);sui.closewait(ui.w)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");sui.closewait(ui.w)}})}(function(a){a.plusReady(function(){ui.channel=plus.os.name=="Android"?2:3;var b=function(){setTimeout(function(){var c=plus.webview.currentWebview();c.close("none",0)},500)};setTimeout(function(){ui.w=sui.wait("请稍候...");refresh()},250);ui.txtbankCard.addEventListener("tap",function(){ui.txtMoney.blur();ui.tradePwd.blur();if(ui.len>0){ui.picker.show(function(c){ui.txtbankCard.value=c[0].text;ui.txtbankCard.setAttribute("data",c[0].value)})}else{sui.open("bankCardList.html","bankCardList.html",{});b()}});ui.forget.addEventListener("tap",function(){sui.open("tradePwd.html","tradePwd.html",{})});ui.txtName.addEventListener("tap",function(){if(ui.StatusCode=="S0014"){sui.open("realName.html","realName.html",{});b()}else{if(ui.StatusCode=="S2000"||ui.StatusCode=="S2001"){sui.open("realState.html","realState.html",{});b()}}});ui.btnSure.addEventListener("tap",function(){var f=ui.txtbankCard.getAttribute("data");var d=ui.txtbankCard.value;var e=ui.txtMoney.value.trim();var g=ui.tradePwd.value.trim();if(ui.StatusCode=="S2000"||ui.StatusCode=="S2001"||ui.StatusCode=="S0014"){a.toast(ui.Desc);return}else{if(ui.len==0){a.toast("您还没有收款账号");return}else{if(ui.AvailBal==0){a.toast("您还没有可提现金额");return}else{if(sui.IsNullOrEmpty(e)){a.toast("请输入提现金额");return}else{if(!e.isFloat()){a.toast("请输入正确的提现金额,允许保留两位小数");return}else{if(sui.IsNullOrEmpty(g)){a.toast("请输入交易密码");return}else{if(ui.AvailBal<e){a.toast("账户余额不足");return}else{if(ui.min>e){a.toast("提现金额不能小于 ¥"+sui.rmoney(ui.min));return}}}}}}}}var c={amount:e,payPassword:g,bankCardId:f,channel:ui.channel};ui.w=sui.wait("正在提交...");sui.post("Fund/Withdraw",c,function(k){if(k){var i=k.IsPass;if(i){var j=plus.webview.getWebviewById("my.html");var h=plus.webview.getWebviewById("myWallet.html");if(h){h.evalJS("refresh();")}if(j){a.fire(j,"mycenter")}sui.closewait(ui.w);setTimeout(function(){sui.open("applySuccess.html","applySuccess.html",{accName:d,money:e});b()},100)}else{a.toast(k.Desc);sui.closewait(ui.w)}}else{a.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w)}})})})})(mui);