var ui={container:sui.gel("container"),imgIdArr:[],timestamp:""};function downloadQueue(c){if(ui.imgIdArr.length>0){var b=ui.imgIdArr.splice(c,1,[]).shift();function a(){if(b.length>0){var d=b.shift();cache.setImg(d.id,d.imgurl,a)}}a()}}window.addEventListener("category",function(a){sui.request("Home/CategoryList",{timestamp:ui.timestamp},true,function(g){if(g){var o=g.IsPass;if(o){var n=g.NeedUpdate;if(n){ui.timestamp=g.Timestamp;var r={listLen:g.ReturnList.length,menu:"",};ui.imgIdArr=[];var m=[];m.push('<div class="mui-col-xs-3"><div id="segmentedControls" class="mui-segmented-control mui-segmented-control-inverted mui-segmented-control-vertical">');m.push('{%menu%}</div></div><div id="segmentedControlContents" class="mui-col-xs-9">');var q="";if(mui.os.ios&&parseFloat(mui.os.version)>8){q="ios-border"}for(var h=0;h<r.listLen;h++){var b=g.ReturnList[h].SubCategory.length;var c="content"+h;r.menu+='<a class="mui-control-item '+(h==0?"mui-active":"")+" "+q+'" href="#'+c+'" data="tab" data-v="'+h+'">'+g.ReturnList[h].Name+"</a>";m.push('<div id="'+c+'" class="mui-control-content '+(h==0?"mui-active":"")+'">');var p=[];for(var f=0;f<b;f++){m.push('<div class="category">'+g.ReturnList[h].SubCategory[f].Name+'</div><ul class="mui-table-view mui-grid-view mui-grid-9">');var l=g.ReturnList[h].SubCategory[f].SubCategory.length;if(l){for(var d=0;d<l;d++){var e=sui.unique(6);p.push({id:e,imgurl:g.ReturnList[h].SubCategory[f].SubCategory[d].Image});m.push('<li class="mui-table-view-cell mui-media mui-col-xs-4 " data="detail" data-v="'+g.ReturnList[h].SubCategory[f].SubCategory[d].CategoryId+'"><a href="#"><img class="mui-media-object" src="images/hand.png"  id="'+e+'"/> <div class="mui-media-body">'+g.ReturnList[h].SubCategory[f].SubCategory[d].Name+"</div></a></li>")}}else{var e=sui.unique(6);p.push({id:e,imgurl:g.ReturnList[h].SubCategory[f].Image});m.push('<li class="mui-table-view-cell mui-media mui-col-xs-4 " data="detail" data-v="'+g.ReturnList[h].SubCategory[f].CategoryId+'"><a href="#"><img class="mui-media-object" src="images/hand.png" id="'+e+'"/> <div class="mui-media-body">'+g.ReturnList[h].SubCategory[f].Name+"</div></a></li>")}m.push("</ul>")}m.push("</div>");ui.imgIdArr.push(p)}m.push("</div>");ui.container.innerHTML=m.join("").replace("{%menu%}",r.menu);setTimeout(function(){downloadQueue(0)},200)}}else{mui.toast(g.Desc)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！")}})});mui(ui.container).on("tap","a[data=tab]",function(){var a=this.getAttribute("data-v");downloadQueue(a)});mui(ui.container).on("tap","li[data=detail]",function(){var a=this.getAttribute("data-v");sui.open("goods/goodsList.html","goodsList.html",{categoryId:a,saletype:0,moduleId:0,searchkey:""})});