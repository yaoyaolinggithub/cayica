var ui={container:sui.gel("container"),w:null,addCard:sui.gel("addCard"),scontent:sui.gel("scontent")};var template=function(f,c,b,e,d){var a=['<li class="mui-table-view-cell"><div class="mui-slider-right mui-disabled">','<a class="mui-btn mui-btn-red" data="delete" data-id="'+f+'">删除</a>','<a class="mui-btn mui-btn-yellow" data="moren" data-id="'+f+'">默认</a></div>','<div class="bank_list mui-slider-handle"><div class="bank_l"><span class="bank_logo '+c+'"></span><span>','</div><div class="bank_r"><span>'+b+" <a>"+e+'</a></span><span class="kahao">'+d+"</span>","</div></div></li>"].join("");return a};function refresh(){sui.request("Fund/GetBankCardList",{},true,function(g){if(g){var f=g.IsPass;if(f){var b=g.ReturnList.length;if(b>0){var d="";for(var e=0;e<b;e++){var a={CardNo:g.ReturnList[e].CardNo,BankName:g.ReturnList[e].BankName,Id:g.ReturnList[e].Id,Default:g.ReturnList[e].DefaultFlag==0?"[默认]":"",classVal:""};if(a.BankName.indexOf("宝")==-1&&a.BankName.indexOf("微")==-1){a.CardNo="尾号 "+a.CardNo.substr(a.CardNo.length-4,4)}switch(a.BankName){case"中国银行":a.classVal="china";break;case"招商银行":a.classVal="zhaos";break;case"平安银行":a.classVal="pingan";break;case"交通银行":a.classVal="jiaotong";break;case"中信银行":a.classVal="zhongx";break;case"浦发银行":a.classVal="pufa";break;case"兴业银行":a.classVal="xingye";break;case"北京银行":a.classVal="beijing";break;case"广发银行":a.classVal="guangfa";break;case"上海银行":a.classVal="shanghai";break;case"宁波银行":a.classVal="ningbo";break;case"汇丰银行":a.classVal="huifeng";break;case"包商银行":a.classVal="baosahng";break;case"杭州银行":a.classVal="hangzhou";break;case"东莞银行":a.classVal="dongguan";break;case"中国工商银行":a.classVal="gongshang";break;case"中国建设银行":a.classVal="jians";break;case"中国农业银行":a.classVal="nongye";break;case"中国邮政储蓄银行":a.classVal="youz";break;case"中国民生银行":a.classVal="mins";break;case"中国光大银行":a.classVal="guangda";break;case"上海农商银行":a.classVal="shnongs";break;case"北京农商银行":a.classVal="bjnongs";break;case"广州农商银行":a.classVal="gznongs";break;case"东莞农村商业银行":a.classVal="dgnongs";break;case"支付宝":a.classVal="zhifubao";break;case"微信":a.classVal="WeChat";break;default:break}var c=template(a.Id,a.classVal,a.BankName,a.Default,a.CardNo);d+=c}ui.container.innerHTML=d}else{ui.container.innerHTML=['<div class="none">','<span class="mui-icon iconfont icon-comiiszanwushuju"></span>','<div class="tips">您还没有添加任何银行账户，快去添加一个吧~</div></div>'].join("")}sui.closewait(ui.w)}else{mui.toast(g.Desc);sui.closewait(ui.w)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");sui.closewait(ui.w)}})}(function(a){if(a.os.ios){ui.scontent.classList.add("ios-scroll-bounce")}a.plusReady(function(){a.init({beforeback:function(){var b=plus.webview.getWebviewById("myWallet.html");if(b){b.evalJS("refresh();")}}});setTimeout(function(){ui.w=sui.wait("正在加载...");refresh()},250)})})(mui);mui("#container").on("tap","a[data=delete]",function(){var b=this.getAttribute("data-id");var a=[{title:"确认",style:"destructive"}];plus.nativeUI.actionSheet({title:"确认要删除该银行账户吗?",cancel:"取消",buttons:a},function(c){if(c.index==1){ui.w=sui.wait("请稍候...");sui.post("Fund/DeleteCard",{cardId:b},function(e){if(e){var d=e.IsPass;if(d){refresh();mui.toast("删除成功")}else{mui.toast(e.Desc)}sui.closewait(ui.w)}else{mui.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w)}})}})});mui("#container").on("tap","a[data=moren]",function(){var a=this.getAttribute("data-id");ui.w=sui.wait("请稍候...");sui.post("Fund/SetDefaultCard",{cardId:a},function(c){if(c){var b=c.IsPass;if(b){refresh();mui.toast("设置成功")}else{mui.toast(c.Desc)}sui.closewait(ui.w)}else{mui.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w)}})});ui.addCard.addEventListener("tap",function(){sui.open("addBank.html","addBank.html",{})});