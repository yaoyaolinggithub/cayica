var ui={addAddr:sui.gel("addAddr"),container:sui.gel("container"),w:null,selectAddr:null};var template=function(f,c,b,e,d){var a=['<ul class="mui-table-view bottom">','<li class="mui-table-view-cell">',"<div>"+c+'  <span class="mui-pull-right">'+b+"</span></div>",'<div class="address">'+e+"</div></li>",'<li class="mui-table-view-cell">','<div class="mui-input-row mui-checkbox  mui-left mui-pull-left">','<label class="'+(d?"active":"")+'">默认地址</label>','<input name="checkbox"  type="checkbox" class="chekbox"  value="'+f+'"  '+(d?'checked="checked"':"")+"/></div>",'<div class="mui-pull-right">','<a class="height" data="edit" data-id="'+f+'"><span class="mui-icon iconfont icon-bianji"></span>编辑</a>','<a class="height" data="del" data-id="'+f+'"><span class="mui-icon iconfont icon-shanchu"></span>删除</a>',"</div></li></ul>"].join("");return a};function getAddr(){sui.request("User/GetAddressList",{},true,function(g){if(g){var f=g.IsPass;if(f){var e=g.ReturnList.length;if(e>0){var c="";for(var d=0;d<e;d++){var a={Id:g.ReturnList[d].Id,ShouHuoRen:g.ReturnList[d].ShouHuoRen,Phone:g.ReturnList[d].Phone,Area:g.ReturnList[d].Area,Address:g.ReturnList[d].Address,IsDefault:g.ReturnList[d].IsDefault};var b=template(a.Id,a.ShouHuoRen,a.Phone,a.Area+a.Address,a.IsDefault);c+=b}ui.container.innerHTML=c;sui.closewait(ui.w)}else{var b=['<div class="none">','<span class="mui-icon iconfont icon-dizhi"></span>','<div class="addr">您还没有收货地址，赶紧去添加一个吧~</div></div>'].join("");ui.container.innerHTML=b;sui.closewait(ui.w)}}else{mui.toast(g.Desc)}sui.closewait(ui.w)}else{mui.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w)}})}(function(a){if(a.os.ios){ui.container.classList.add("ios-scroll-bounce")}a.plusReady(function(){a.init({beforeback:function(){if(ui.selectAddr&&ui.selectAddr=="selectAddr"){var b=plus.webview.currentWebview().opener();if(b){b.evalJS("getAddr();")}}}});ui.selectAddr=plus.webview.currentWebview().selectAddr;setTimeout(function(){ui.w=sui.wait("正在加载...");getAddr()},250)})})(mui);mui("body").on("tap","a[data=edit]",function(){var a=this.getAttribute("data-id");sui.open("editAddr.html","editAddr.html",{addrId:a})});mui("body").on("tap","a[data=del]",function(){var a=this;var b=[{title:"确认",style:"destructive"}];plus.nativeUI.actionSheet({title:"确认要删除该地址吗?",cancel:"取消",buttons:b},function(c){if(c.index==1){var d=a.getAttribute("data-id");ui.w=sui.wait("请稍候...");sui.post("User/DeleteAddress",{addressId:d},function(f){if(f){var e=f.IsPass;if(e){getAddr();mui.toast("删除成功")}else{mui.toast(f.Desc)}sui.closewait(ui.w)}else{mui.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w)}})}})});mui("#container").on("change","input",function(){var a=this;var b=a.value;ui.w=sui.wait("请稍候...");sui.post("User/SetDefaultAddress",{addressId:b},function(d){if(d){var c=d.IsPass;if(c){getAddr();mui.toast("设置成功")}else{mui.toast(d.Desc);setTimeout(function(){a.checked=false},0)}sui.closewait(ui.w)}else{mui.toast("无法连接到服务器，请检查网络是否连接");sui.closewait(ui.w);setTimeout(function(){a.checked=false},0)}})});ui.addAddr.addEventListener("tap",function(){sui.open("addAddr.html","addAddr.html",{})});