var ui={w:null,container:sui.gel("container"),imgIdArr:[],nav:sui.gel("nav"),subreturn:sui.gel("subreturn"),checkAll:sui.gel("checkAll"),elem:null,scontent:sui.gel("scontent")};var template=function(b){var e=b.SkuAttribute;var f='<span class="guige">产品型号：'+b.StockCode+" </span>";if(!sui.IsNullOrEmpty(e)){e=JSON.parse(e||"[]");var a=e.length;for(var d=0;d<a;d++){if(d==2){break}f+='<span class="guige">'+e[d].AttrName+"："+e[d].AttrVal+" </span>"}}var c=['<li class="mui-table-view-cell"> <span class="mui-checkbox cbox">','<input type="checkbox" value="'+JSON.stringify(b).replace(/\"/ig,"'")+'"/></span><img src="../images/hand.png"  id="'+b.unique+'" data="order" data-v="'+b.OrderId+'"/>','<div class="order_tit tit-fir" data-v="'+b.OrderId+'" data="order"><div class="mui-ellipsis-2 tit" >'+b.SkuName+"</div>",'<div class="top12">'+f,'</div> </div><span class="mui-badge ">×'+b.BuyNum+"</span></li>"].join("");return c};(function(a){if(a.os.ios){ui.scontent.classList.add("ios-scroll-bounce")}a.plusReady(function(){setTimeout(function(){ui.w=sui.wait("正在加载...");pulldownRefresh()},250)})})(mui);function pulldownRefresh(){sui.request("Order/GetOrderProductList",{},true,function(h){if(h){var g=h.IsPass;if(g){var f=h.ReturnDataTable.length;if(f>0){ui.container.innerHTML="";ui.elem=sui.rtips(ui.elem);var c="";for(var d=0;d<f;d++){var b={OrderId:h.ReturnDataTable[d].OrderId,SkuName:h.ReturnDataTable[d].SkuName,BuyNum:h.ReturnDataTable[d].BuyNum,NowDeposit:h.ReturnDataTable[d].NowDeposit,ProductSkuId:h.ReturnDataTable[d].ProductSkuId,SkuAttribute:h.ReturnDataTable[d].SkuAttribute,Rent:h.ReturnDataTable[d].Rent,Periods:h.ReturnDataTable[d].Periods,StockDetailId:h.ReturnDataTable[d].StockDetailId,StockCode:h.ReturnDataTable[d].StockCode,CoverImage:h.ReturnDataTable[d].CoverImage,unique:sui.unique(6)};ui.imgIdArr.push({id:b.unique,imgurl:b.CoverImage});c+=template(b)}ui.container.innerHTML=c;var e=ui.imgIdArr.length;for(var a=0;a<e;a++){cache.setImg(ui.imgIdArr[a].id,ui.imgIdArr[a].imgurl)}ui.nav.classList.remove("mui-hidden");ui.imgIdArr=[]}else{ui.nav.classList.add("mui-hidden");ui.container.innerHTML="";if(!ui.elem){ui.elem=sui.ctips("comiiszanwushuju","暂无相关数据")}}sui.closewait(ui.w)}else{mui.toast(h.Desc);sui.closewait(ui.w)}}else{mui.toast("无法连接到服务器，请检查网络是否连接！");sui.closewait(ui.w)}})}ui.subreturn.addEventListener("tap",function(){var a=[];var b=ui.container.querySelectorAll('input[type="checkbox"]:checked').length;if(b>0){var c=[].slice.call(ui.container.querySelectorAll('input[type="checkbox"]:checked'));c.forEach(function(e,d){a.push(JSON.parse(e.value.replace(/\'/ig,'"')))});sui.open("applyRecover.html","applyRecover.html",{result:JSON.stringify(a)})}else{mui.toast("至少选择一件商品哦")}});ui.checkAll.addEventListener("change",function(){var a=this.checked;var b=[].slice.call(ui.container.querySelectorAll('input[type="checkbox"]'));b.forEach(function(d,c){d.checked=a})});mui("#container").on("tap","div[data=order]",function(){var a=this.getAttribute("data-v");sui.open("orderDetail.html","orderDetail.html",{orderId:a})});mui("#container").on("tap","img[data=order]",function(){var a=this.getAttribute("data-v");sui.open("orderDetail.html","orderDetail.html",{orderId:a})});